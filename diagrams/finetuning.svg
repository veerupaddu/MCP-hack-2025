<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800">
  <defs>
    <style>
      .title { font: bold 24px sans-serif; fill: #1a1a1a; }
      .subtitle { font: 16px sans-serif; fill: #666; }
      .box { fill: #f0f7ff; stroke: #2563eb; stroke-width: 2; }
      .box-header { fill: #2563eb; }
      .box-text { font: 14px sans-serif; fill: #1a1a1a; }
      .box-header-text { font: bold 14px sans-serif; fill: white; }
      .arrow { stroke: #2563eb; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .metric { font: 12px monospace; fill: #059669; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2563eb" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="40" class="title" text-anchor="middle">Fine-Tuning Pipeline - Phi-3-mini with vLLM</text>
  <text x="600" y="65" class="subtitle" text-anchor="middle">High-Performance Model Training &amp; Deployment</text>
  
  <!-- Step 1: Data Preparation -->
  <rect x="50" y="120" width="220" height="180" class="box" rx="8"/>
  <rect x="50" y="120" width="220" height="40" class="box-header" rx="8"/>
  <text x="160" y="145" class="box-header-text" text-anchor="middle">1. DATA PREPARATION</text>
  <text x="160" y="185" class="box-text" text-anchor="middle">üìä Japan Census CSV</text>
  <text x="160" y="210" class="box-text" text-anchor="middle" font-weight="bold">201,651 samples</text>
  <text x="160" y="235" class="box-text" text-anchor="middle">QA Generation (Gemini)</text>
  <text x="160" y="260" class="box-text" text-anchor="middle">Train/Val Split (80/20)</text>
  <text x="160" y="285" class="metric" text-anchor="middle">‚Üí train.jsonl / val.jsonl</text>
  
  <!-- Arrow 1 -->
  <path d="M 270 210 L 320 210" class="arrow"/>
  
  <!-- Step 2: Fine-Tuning -->
  <rect x="320" y="120" width="240" height="180" class="box" rx="8"/>
  <rect x="320" y="120" width="240" height="40" class="box-header" rx="8"/>
  <text x="440" y="145" class="box-header-text" text-anchor="middle">2. FINE-TUNING</text>
  <text x="440" y="180" class="box-text" text-anchor="middle">üñ•Ô∏è Modal H200 GPU</text>
  <text x="440" y="205" class="box-text" text-anchor="middle">Phi-3-mini-4k-instruct</text>
  <text x="440" y="230" class="box-text" text-anchor="middle">LoRA (r=16, Œ±=16)</text>
  <text x="440" y="255" class="box-text" text-anchor="middle">4-bit Quantization</text>
  <text x="440" y="280" class="metric" text-anchor="middle">10,000 steps ‚Üí adapter</text>
  
  <!-- Arrow 2 -->
  <path d="M 560 210 L 610 210" class="arrow"/>
  
  <!-- Step 3: Model Merging -->
  <rect x="610" y="120" width="240" height="180" class="box" rx="8"/>
  <rect x="610" y="120" width="240" height="40" class="box-header" rx="8"/>
  <text x="730" y="145" class="box-header-text" text-anchor="middle">3. MODEL MERGING</text>
  <text x="730" y="180" class="box-text" text-anchor="middle">üîÑ Modal A10G GPU</text>
  <text x="730" y="205" class="box-text" text-anchor="middle">Merge LoRA + Base</text>
  <text x="730" y="230" class="box-text" text-anchor="middle">Save as bfloat16</text>
  <text x="730" y="255" class="box-text" text-anchor="middle">‚Üí merged_model/</text>
  <text x="730" y="280" class="metric" text-anchor="middle">model-checkpoints volume</text>
  
  <!-- Arrow 3 -->
  <path d="M 730 300 L 730 350" class="arrow"/>
  
  <!-- Step 4: Deployment Options -->
  <rect x="900" y="120" width="250" height="180" class="box" rx="8"/>
  <rect x="900" y="120" width="250" height="40" class="box-header" rx="8"/>
  <text x="1025" y="145" class="box-header-text" text-anchor="middle">4. DEPLOYMENT</text>
  
  <!-- Option A -->
  <rect x="920" y="175" width="210" height="50" fill="#e0f2fe" stroke="#0284c7" stroke-width="1" rx="4"/>
  <text x="1025" y="195" class="box-text" text-anchor="middle" font-weight="bold">Option A: Standard API</text>
  <text x="1025" y="215" class="box-text" text-anchor="middle" font-size="12">Transformers + PEFT</text>
  
  <!-- Option B -->
  <rect x="920" y="235" width="210" height="50" fill="#d1fae5" stroke="#059669" stroke-width="2" rx="4"/>
  <text x="1025" y="255" class="box-text" text-anchor="middle" font-weight="bold">Option B: vLLM API ‚ö°</text>
  <text x="1025" y="275" class="metric" text-anchor="middle" font-weight="bold">&lt;3s latency</text>
  
  <!-- Arrow to deployments -->
  <path d="M 850 210 L 900 210" class="arrow"/>
  
  <!-- Performance Metrics Box -->
  <rect x="50" y="350" width="800" height="120" fill="#f0fdf4" stroke="#059669" stroke-width="2" rx="8"/>
  <text x="450" y="380" class="box-text" text-anchor="middle" font-weight="bold" font-size="16">Performance Metrics</text>
  
  <text x="200" y="410" class="box-text">Training Time: ~2-3 hours</text>
  <text x="200" y="435" class="box-text">GPU Memory: ~40GB (H200)</text>
  <text x="200" y="460" class="box-text">Dataset Size: 201,651 samples</text>
  
  <text x="550" y="410" class="metric" font-weight="bold">Inference Latency:</text>
  <text x="550" y="435" class="box-text">Standard API: ~10s</text>
  <text x="550" y="460" class="metric" font-weight="bold">vLLM API: &lt;3s ‚ú®</text>
  
  <!-- Tech Stack -->
  <rect x="50" y="500" width="800" height="100" fill="#fef3c7" stroke="#d97706" stroke-width="2" rx="8"/>
  <text x="450" y="530" class="box-text" text-anchor="middle" font-weight="bold" font-size="16">Technology Stack</text>
  <text x="450" y="560" class="box-text" text-anchor="middle">Modal ‚Ä¢ PyTorch 2.4.0 ‚Ä¢ Transformers 4.44.2 ‚Ä¢ PEFT 0.12.0 ‚Ä¢ vLLM 0.6.3 ‚Ä¢ bitsandbytes 0.43.3</text>
  <text x="450" y="585" class="box-text" text-anchor="middle">LoRA Fine-Tuning ‚Ä¢ 4-bit Quantization ‚Ä¢ Async Inference Engine</text>
  
  <!-- Endpoints -->
  <rect x="900" y="350" width="250" height="250" fill="#faf5ff" stroke="#7c3aed" stroke-width="2" rx="8"/>
  <text x="1025" y="380" class="box-text" text-anchor="middle" font-weight="bold" font-size="16">API Endpoints</text>
  
  <text x="1025" y="415" class="box-text" text-anchor="middle" font-size="12" font-weight="bold">Standard:</text>
  <text x="1025" y="435" class="metric" text-anchor="middle" font-size="10">phi3-inference-gpu</text>
  
  <text x="1025" y="470" class="box-text" text-anchor="middle" font-size="12" font-weight="bold">vLLM (Optimized):</text>
  <text x="1025" y="490" class="metric" text-anchor="middle" font-size="10">phi3-inference-vllm</text>
  
  <text x="1025" y="525" class="box-text" text-anchor="middle" font-size="12" font-weight="bold">Evaluation:</text>
  <text x="1025" y="545" class="metric" text-anchor="middle" font-size="10">eval-finetuned</text>
  
  <text x="1025" y="580" class="box-text" text-anchor="middle" font-size="11">All on Modal A10G GPU</text>
  
  <!-- Footer -->
  <text x="600" y="780" class="subtitle" text-anchor="middle" font-size="12">Updated: 2025-11-30 | Architecture: vLLM-Optimized Pipeline</text>
</svg>
