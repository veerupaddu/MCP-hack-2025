<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 700">
  <defs>
    <style>
      .title { font: bold 22px sans-serif; fill: #1a1a1a; }
      .subtitle { font: 15px sans-serif; fill: #666; }
      .box { fill: #f0f7ff; stroke: #2563eb; stroke-width: 2; }
      .box-header { fill: #2563eb; }
      .box-text { font: 13px sans-serif; fill: #1a1a1a; }
      .box-header-text { font: bold 13px sans-serif; fill: white; }
      .arrow { stroke: #2563eb; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .metric { font: 12px monospace; fill: #059669; font-weight: bold; }
      .fast { fill: #d1fae5; stroke: #059669; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2563eb" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="500" y="40" class="title" text-anchor="middle">RAG Query Flow - Medium Detail</text>
  <text x="500" y="65" class="subtitle" text-anchor="middle">Optimized Retrieval-Augmented Generation Pipeline</text>
  
  <!-- User Query -->
  <rect x="50" y="120" width="160" height="90" class="box" rx="8"/>
  <rect x="50" y="120" width="160" height="35" class="box-header" rx="8"/>
  <text x="130" y="142" class="box-header-text" text-anchor="middle">USER QUERY</text>
  <text x="130" y="175" class="box-text" text-anchor="middle">ðŸ’¬ Question</text>
  <text x="130" y="195" class="box-text" text-anchor="middle">via API</text>
  
  <path d="M 210 165 L 260 165" class="arrow"/>
  
  <!-- Embedding -->
  <rect x="260" y="120" width="180" height="90" class="box" rx="8"/>
  <rect x="260" y="120" width="180" height="35" class="box-header" rx="8"/>
  <text x="350" y="142" class="box-header-text" text-anchor="middle">EMBEDDING</text>
  <text x="350" y="175" class="box-text" text-anchor="middle">bge-small-en-v1.5</text>
  <text x="350" y="195" class="metric" text-anchor="middle">~2ms</text>
  
  <path d="M 440 165 L 490 165" class="arrow"/>
  
  <!-- Vector Search -->
  <rect x="490" y="120" width="200" height="90" class="fast" rx="8"/>
  <rect x="490" y="120" width="200" height="35" class="box-header" rx="8"/>
  <text x="590" y="142" class="box-header-text" text-anchor="middle">VECTOR SEARCH</text>
  <text x="590" y="175" class="box-text" text-anchor="middle">ChromaDB (Local)</text>
  <text x="590" y="195" class="metric" text-anchor="middle">~400ms âš¡</text>
  
  <path d="M 590 210 L 590 260" class="arrow"/>
  
  <!-- Retrieved Context -->
  <rect x="490" y="260" width="200" height="90" class="box" rx="8"/>
  <rect x="490" y="260" width="200" height="35" class="box-header" rx="8"/>
  <text x="590" y="282" class="box-header-text" text-anchor="middle">CONTEXT</text>
  <text x="590" y="315" class="box-text" text-anchor="middle">Top-3 documents</text>
  <text x="590" y="335" class="box-text" text-anchor="middle">+ metadata</text>
  
  <path d="M 490 305 L 440 305" class="arrow"/>
  
  <!-- Prompt Construction -->
  <rect x="260" y="260" width="180" height="90" class="box" rx="8"/>
  <rect x="260" y="260" width="180" height="35" class="box-header" rx="8"/>
  <text x="350" y="282" class="box-header-text" text-anchor="middle">PROMPT</text>
  <text x="350" y="315" class="box-text" text-anchor="middle">Alpaca Template</text>
  <text x="350" y="335" class="box-text" text-anchor="middle">Context + Question</text>
  
  <path d="M 350 350 L 350 400" class="arrow"/>
  
  <!-- vLLM Generation -->
  <rect x="210" y="400" width="280" height="120" class="fast" rx="8"/>
  <rect x="210" y="400" width="280" height="40" class="box-header" rx="8"/>
  <text x="350" y="425" class="box-header-text" text-anchor="middle" font-size="15">vLLM ENGINE</text>
  <text x="350" y="460" class="box-text" text-anchor="middle">Phi-3-mini (Fine-tuned)</text>
  <text x="350" y="480" class="box-text" text-anchor="middle">AsyncLLMEngine</text>
  <text x="350" y="505" class="metric" text-anchor="middle">~2-3s</text>
  
  <path d="M 490 460 L 540 460" class="arrow"/>
  
  <!-- Response -->
  <rect x="540" y="400" width="200" height="120" class="box" rx="8"/>
  <rect x="540" y="400" width="200" height="40" class="box-header" rx="8"/>
  <text x="640" y="425" class="box-header-text" text-anchor="middle">RESPONSE</text>
  <text x="640" y="460" class="box-text" text-anchor="middle">âœ… Answer</text>
  <text x="640" y="480" class="box-text" text-anchor="middle">ðŸ“„ Sources</text>
  <text x="640" y="505" class="metric" text-anchor="middle">Total: &lt;3s</text>
  
  <!-- Performance Box -->
  <rect x="50" y="400" width="140" height="180" fill="#f0fdf4" stroke="#059669" stroke-width="2" rx="8"/>
  <text x="120" y="425" class="box-text" text-anchor="middle" font-weight="bold">Latency</text>
  <text x="60" y="455" class="box-text">Embed:</text>
  <text x="170" y="455" class="metric" text-anchor="end">2ms</text>
  <text x="60" y="480" class="box-text">Search:</text>
  <text x="170" y="480" class="metric" text-anchor="end">400ms</text>
  <text x="60" y="505" class="box-text">Generate:</text>
  <text x="170" y="505" class="metric" text-anchor="end">2-3s</text>
  <rect x="60" y="520" width="110" height="30" fill="#d1fae5" stroke="#059669" stroke-width="1" rx="4"/>
  <text x="120" y="542" class="metric" text-anchor="middle" font-size="14">&lt;3s âš¡</text>
  <text x="120" y="570" class="box-text" text-anchor="middle" font-size="11">Modal A10G</text>
  
  <!-- Tech Stack -->
  <rect x="50" y="610" width="690" height="70" fill="#fef3c7" stroke="#d97706" stroke-width="2" rx="8"/>
  <text x="395" y="640" class="box-text" text-anchor="middle" font-weight="bold" font-size="15">Technology Stack</text>
  <text x="395" y="665" class="box-text" text-anchor="middle">vLLM 0.6.3 â€¢ ChromaDB 0.5.20 â€¢ LangChain 0.3.7 â€¢ sentence-transformers 3.3.0 â€¢ FastAPI</text>
  
  <!-- Footer -->
  <text x="500" y="695" class="subtitle" text-anchor="middle" font-size="11">Endpoint: rag-vllm-optimized | Updated: 2025-11-30</text>
</svg>