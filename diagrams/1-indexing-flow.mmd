sequenceDiagram
    participant User
    participant Modal
    participant CreateVectorDB as create_vector_db()
    participant PDFLoader
    participant TextSplitter
    participant Embeddings as HuggingFaceEmbeddings<br/>(CUDA)
    participant ChromaDB as Remote ChromaDB

    User->>Modal: modal run modal-rag.py::index
    Modal->>CreateVectorDB: Execute function
    
    CreateVectorDB->>PDFLoader: Load PDFs from /insurance-data
    PDFLoader-->>CreateVectorDB: Return documents
    
    CreateVectorDB->>TextSplitter: Split documents (chunk_size=1000)
    TextSplitter-->>CreateVectorDB: Return chunks
    
    CreateVectorDB->>Embeddings: Initialize (device='cuda')
    CreateVectorDB->>Embeddings: Generate embeddings for chunks
    Embeddings-->>CreateVectorDB: Return embeddings
    
    CreateVectorDB->>ChromaDB: Connect to remote service
    CreateVectorDB->>ChromaDB: Upsert chunks + embeddings
    ChromaDB-->>CreateVectorDB: Confirm storage
    
    CreateVectorDB-->>Modal: Complete
    Modal-->>User: Success message
