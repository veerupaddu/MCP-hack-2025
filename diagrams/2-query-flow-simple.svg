<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 700">
  <defs>
    <style>
      .title { font: bold 24px sans-serif; fill: #1a1a1a; }
      .subtitle { font: 16px sans-serif; fill: #666; }
      .box { fill: #f0f7ff; stroke: #2563eb; stroke-width: 2; }
      .box-header { fill: #2563eb; }
      .box-text { font: 14px sans-serif; fill: #1a1a1a; }
      .box-header-text { font: bold 14px sans-serif; fill: white; }
      .arrow { stroke: #2563eb; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .metric { font: 12px monospace; fill: #059669; font-weight: bold; }
      .fast { fill: #d1fae5; stroke: #059669; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2563eb" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="40" class="title" text-anchor="middle">RAG Query Flow - vLLM Optimized</text>
  <text x="600" y="65" class="subtitle" text-anchor="middle">High-Performance Retrieval-Augmented Generation</text>
  
  <!-- Step 1: User Query -->
  <rect x="50" y="120" width="180" height="120" class="box" rx="8"/>
  <rect x="50" y="120" width="180" height="40" class="box-header" rx="8"/>
  <text x="140" y="145" class="box-header-text" text-anchor="middle">1. USER QUERY</text>
  <text x="140" y="185" class="box-text" text-anchor="middle" font-size="16">üí¨</text>
  <text x="140" y="210" class="box-text" text-anchor="middle">"What insurance</text>
  <text x="140" y="230" class="box-text" text-anchor="middle">products available?"</text>
  
  <!-- Arrow 1 -->
  <path d="M 230 180 L 280 180" class="arrow"/>
  
  <!-- Step 2: Embedding -->
  <rect x="280" y="120" width="180" height="120" class="box" rx="8"/>
  <rect x="280" y="120" width="180" height="40" class="box-header" rx="8"/>
  <text x="370" y="145" class="box-header-text" text-anchor="middle">2. EMBEDDING</text>
  <text x="370" y="180" class="box-text" text-anchor="middle">üìä bge-small-en-v1.5</text>
  <text x="370" y="205" class="box-text" text-anchor="middle">GPU: CUDA</text>
  <text x="370" y="230" class="metric" text-anchor="middle">~2ms</text>
  
  <!-- Arrow 2 -->
  <path d="M 460 180 L 510 180" class="arrow"/>
  
  <!-- Step 3: Vector Search -->
  <rect x="510" y="120" width="200" height="120" class="fast" rx="8"/>
  <rect x="510" y="120" width="200" height="40" class="box-header" rx="8"/>
  <text x="610" y="145" class="box-header-text" text-anchor="middle">3. VECTOR SEARCH</text>
  <text x="610" y="180" class="box-text" text-anchor="middle">üíæ ChromaDB (Local)</text>
  <text x="610" y="205" class="box-text" text-anchor="middle">3,766 documents</text>
  <text x="610" y="230" class="metric" text-anchor="middle">~400ms ‚ö°</text>
  
  <!-- Arrow 3 -->
  <path d="M 610 240 L 610 290" class="arrow"/>
  
  <!-- Step 4: Context Retrieved -->
  <rect x="510" y="290" width="200" height="100" class="box" rx="8"/>
  <rect x="510" y="290" width="200" height="40" class="box-header" rx="8"/>
  <text x="610" y="315" class="box-header-text" text-anchor="middle">4. CONTEXT</text>
  <text x="610" y="350" class="box-text" text-anchor="middle">Top 3 documents</text>
  <text x="610" y="375" class="box-text" text-anchor="middle">+ metadata</text>
  
  <!-- Arrow 4 -->
  <path d="M 610 390 L 610 440" class="arrow"/>
  
  <!-- Step 5: vLLM Generation -->
  <rect x="460" y="440" width="300" height="140" class="fast" rx="8"/>
  <rect x="460" y="440" width="300" height="40" class="box-header" rx="8"/>
  <text x="610" y="465" class="box-header-text" text-anchor="middle">5. vLLM GENERATION</text>
  <text x="610" y="500" class="box-text" text-anchor="middle">ü§ñ Phi-3-mini (Fine-tuned)</text>
  <text x="610" y="525" class="box-text" text-anchor="middle">AsyncLLMEngine</text>
  <text x="610" y="550" class="box-text" text-anchor="middle">GPU Memory: 70%</text>
  <text x="610" y="575" class="metric" text-anchor="middle">~2-3s ‚ö°</text>
  
  <!-- Arrow 5 -->
  <path d="M 760 510 L 810 510" class="arrow"/>
  
  <!-- Step 6: Response -->
  <rect x="810" y="440" width="180" height="140" class="box" rx="8"/>
  <rect x="810" y="440" width="180" height="40" class="box-header" rx="8"/>
  <text x="900" y="465" class="box-header-text" text-anchor="middle">6. RESPONSE</text>
  <text x="900" y="500" class="box-text" text-anchor="middle">‚úÖ Answer</text>
  <text x="900" y="525" class="box-text" text-anchor="middle">üìÑ Sources</text>
  <text x="900" y="550" class="box-text" text-anchor="middle">‚è±Ô∏è Metrics</text>
  <text x="900" y="575" class="metric" text-anchor="middle">Total: &lt;3s</text>
  
  <!-- Performance Box -->
  <rect x="50" y="440" width="350" height="140" fill="#f0fdf4" stroke="#059669" stroke-width="2" rx="8"/>
  <text x="225" y="470" class="box-text" text-anchor="middle" font-weight="bold" font-size="16">Performance Breakdown</text>
  <text x="80" y="505" class="box-text">Embedding:</text>
  <text x="300" y="505" class="metric" text-anchor="end">~2ms</text>
  <text x="80" y="530" class="box-text">Vector Search:</text>
  <text x="300" y="530" class="metric" text-anchor="end">~400ms</text>
  <text x="80" y="555" class="box-text">LLM Generation:</text>
  <text x="300" y="555" class="metric" text-anchor="end">~2-3s</text>
  <text x="225" y="575" class="metric" text-anchor="middle" font-size="16">TOTAL: &lt;3s ‚ú®</text>
  
  <!-- Architecture Details -->
  <rect x="50" y="610" width="940" height="70" fill="#fef3c7" stroke="#d97706" stroke-width="2" rx="8"/>
  <text x="520" y="640" class="box-text" text-anchor="middle" font-weight="bold" font-size="16">Architecture: Modal A10G GPU</text>
  <text x="520" y="665" class="box-text" text-anchor="middle">vLLM 0.6.3 ‚Ä¢ ChromaDB 0.5.20 ‚Ä¢ LangChain 0.3.7 ‚Ä¢ sentence-transformers 3.3.0</text>
  
  <!-- Footer -->
  <text x="600" y="695" class="subtitle" text-anchor="middle" font-size="12">Endpoint: rag-vllm-optimized | Updated: 2025-11-30</text>
</svg>